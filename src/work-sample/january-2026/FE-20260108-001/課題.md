# requestId による完全防御

- 課題 ID：FE-20260108-001
- 課題難易度：やや易〜中・発展

## 課題内容

最新のリクエストだけを“正”として扱う

### 要件

- ボタンを押すと fetch を実行
- ローディング状態を表示
- 成功時：データを表示
- 失敗時：エラーメッセージを表示
- useEffect は使わない
- onClick + async / await

### 追加要件（発展）

- リクエストごとに requestId を発行する
- 最新の requestId 以外のレスポンスは 必ず無視
- 古いレスポンスで state を更新してはいけない

### 実装ルール

- requestId は useRef で管理
- fetch 開始時に requestId をインクリメント
- レスポンス処理時に
  - 自分の requestId === 最新 requestId のときだけ state 更新

### ヒント（設計寄り）

- AbortController と 併用しなくてOK（今日は requestId に集中）
- finally でも requestId チェックを忘れない
- state 構成は前課題と同じでOK

### 提出物

- プログラムコード
- AbortController だけでは足りない理由
- requestId が「防いでいるもの」を1文で

### 評価観点

- ref の使いどころが正しいか
- 「最後の操作が勝つ」設計になっているか
- ロジックが過剰になっていないか

---

## 提出物の問いへの回答

> AbortController だけでは足りない理由

AbortControllerはリクエストの中断はできるけど、すでに返ってきたレスポンスを止めることができない。

> requestId が「防いでいるもの」を1文で

古いリクエストのレスポンスを止める。
